<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Rest Api creador por Zioo" />
    <meta name="keywords" content="Api para WhatsApp Bot" />
    <meta name="author" content="Zioo" />
    <meta property="og:title" content="La curalacha">
    <meta property="og:description" content="Welcome to the curalacha">
    <meta property="og:image" content="images/happy.jpg">
    <title>¡Esto es Especial!</title>
    <link rel="icon" href="images/happy.png" type="image/x-icon">
    <link rel="shortcut icon" href="images/happy.png" type="image/x-icon">
    <link rel="stylesheet" href="css/index.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.2.6/gsap.min.js"></script>
</head>

<body>
    <div id="all">
        <div class="cursor"></div>
        <div id="loader">
            <span class="color">Comentarios</span>
        </div>
        <div id="breaker"></div>
        <div id="breaker-two"></div>
        <div id="blog-header">
            <div class="social-media-links2">
                <div id="footer-u">
                    <div class="secondline">
                        La Curalacha
                        <span class="txt-rotate color" data-period="1200" data-rotate='[ " Ale.", " Jamie.", " Luuu." ]'></span>
                        <span class="slash">|</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="blog-content">
            <!-- COMENTARIOS -->
            
            <div id="comments-container"></div>

            <!-- FIN DE COMENTARIOS -->
            <div class="blogs">
                <div class="form-header">Envia un comentario</div>
                <form id="myForm" action="#">
                    <div class="input-line">
                        <p class="text">Nombre</p>
                        <input id="name" type="text" placeholder="Escribe tu nombre" class="input-name">
                    </div>
                    <div class="input-line">
                        <p class="text">Mensaje</p>
                        <textarea id="body" class="input-textarea" placeholder="Escribe tu mensaje"></textarea>
                    </div>
                    <button type="button" id="submit" value="send">Enviar</button>
                </form>
            </div>
        </div>
    </div>

    <script src="js/jquery.min.js"></script>
    <script src="js/index.js"></script>
    <script>
document.addEventListener("DOMContentLoaded", function () {
    const form = document.getElementById("myForm");
    const commentsContainer = document.getElementById("comments-container");

    form.addEventListener("submit", function (event) {
        event.preventDefault(); // Evita que el formulario se envíe de manera predeterminada

        const nameInput = document.getElementById("name");
        const bodyInput = document.getElementById("body");

        const name = nameInput.value;
        const body = bodyInput.value;

        if (name && body) {
            // Crear un objeto de comentario
            const comment = {
                name: name,
                body: body
            };

            // Obtener comentarios existentes (si los hay) o crear un nuevo array
            const existingComments = JSON.parse(localStorage.getItem("comments")) || [];

            // Agregar el nuevo comentario
            existingComments.push(comment);

            // Guardar comentarios en el almacenamiento local
            localStorage.setItem("comments", JSON.stringify(existingComments));

            // Limpiar los campos del formulario
            nameInput.value = "";
            bodyInput.value = "";

            // Mostrar los comentarios actualizados
            displayComments(existingComments);

            // Guardar comentarios en el archivo comment.json
            saveCommentsToJSON(existingComments);
        }
    });

    // Función para mostrar comentarios
    function displayComments(comments) {
        commentsContainer.innerHTML = "";
        comments.forEach(function (comment) {
            const commentDiv = document.createElement("div");
            commentDiv.innerHTML = `<strong>${comment.name}:</strong> ${comment.body}`;
            commentsContainer.appendChild(commentDiv);
        });
    }

    // Función para guardar comentarios en el archivo comment.json
    function saveCommentsToJSON(comments) {
        const jsonComments = JSON.stringify(comments);

        // Realizar una solicitud AJAX para guardar en comment.json
        const xhr = new XMLHttpRequest();
        xhr.open("POST", "comment.json", true);
        xhr.setRequestHeader("Content-type", "application/json;charset=UTF-8");
        xhr.send(jsonComments);
    }

    // Obtener y mostrar comentarios desde comment.json al cargar la página
    function getCommentsFromJSON() {
        const xhr = new XMLHttpRequest();
        xhr.open("GET", "comment.json", true);
        xhr.onreadystatechange = function () {
            if (xhr.readyState === 4 && xhr.status === 200) {
                const comments = JSON.parse(xhr.responseText);
                displayComments(comments);
            }
        };
        xhr.send();
    }

    getCommentsFromJSON();
});

    </script>
</body>

</html>
